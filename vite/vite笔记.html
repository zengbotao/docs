<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1Vite前言 | zengbotao</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/assets/img/favicon.ico">
    <link rel="manifest" href="/assets/img/manifest.json">
    <link rel="apple-touch-icon" href="/assets/img/logo.png">
    <link rel="mask-icon" href="/assets/img/favicon.ico" color="#3eaf7c">
    <meta name="description" content="">
    <meta name="keywords" content="前端">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/img/logo.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.80bd9150.css" as="style"><link rel="preload" href="/assets/js/app.6347ca4c.js" as="script"><link rel="preload" href="/assets/js/10.5d924c5c.js" as="script"><link rel="preload" href="/assets/js/45.2b87470c.js" as="script"><link rel="preload" href="/assets/js/12.da65b27a.js" as="script"><link rel="prefetch" href="/assets/js/11.6de431dc.js"><link rel="prefetch" href="/assets/js/13.495608c3.js"><link rel="prefetch" href="/assets/js/14.05e2ede3.js"><link rel="prefetch" href="/assets/js/15.e4fc65f3.js"><link rel="prefetch" href="/assets/js/16.a720d7a9.js"><link rel="prefetch" href="/assets/js/17.6a0f3383.js"><link rel="prefetch" href="/assets/js/18.323ff6cb.js"><link rel="prefetch" href="/assets/js/19.ac2c5137.js"><link rel="prefetch" href="/assets/js/2.d8203abb.js"><link rel="prefetch" href="/assets/js/20.00d51dcd.js"><link rel="prefetch" href="/assets/js/21.91055b2a.js"><link rel="prefetch" href="/assets/js/22.4d6ac126.js"><link rel="prefetch" href="/assets/js/23.8235cb48.js"><link rel="prefetch" href="/assets/js/24.f2c784eb.js"><link rel="prefetch" href="/assets/js/25.d85a0879.js"><link rel="prefetch" href="/assets/js/26.c0646818.js"><link rel="prefetch" href="/assets/js/27.4b437a15.js"><link rel="prefetch" href="/assets/js/28.498f65b5.js"><link rel="prefetch" href="/assets/js/29.e8496c16.js"><link rel="prefetch" href="/assets/js/3.abca1c39.js"><link rel="prefetch" href="/assets/js/30.b340e208.js"><link rel="prefetch" href="/assets/js/31.6888ab7d.js"><link rel="prefetch" href="/assets/js/32.8595eb32.js"><link rel="prefetch" href="/assets/js/33.50880272.js"><link rel="prefetch" href="/assets/js/34.7ea11592.js"><link rel="prefetch" href="/assets/js/35.b4704321.js"><link rel="prefetch" href="/assets/js/36.af1517fd.js"><link rel="prefetch" href="/assets/js/37.a2b03e09.js"><link rel="prefetch" href="/assets/js/38.3c52bf0c.js"><link rel="prefetch" href="/assets/js/39.365c7616.js"><link rel="prefetch" href="/assets/js/4.49b75b99.js"><link rel="prefetch" href="/assets/js/40.798a6faa.js"><link rel="prefetch" href="/assets/js/41.fb637bca.js"><link rel="prefetch" href="/assets/js/42.c538cfb3.js"><link rel="prefetch" href="/assets/js/43.48254a4d.js"><link rel="prefetch" href="/assets/js/44.aba307f6.js"><link rel="prefetch" href="/assets/js/46.c53582bc.js"><link rel="prefetch" href="/assets/js/47.97ba28ed.js"><link rel="prefetch" href="/assets/js/48.329396d2.js"><link rel="prefetch" href="/assets/js/49.c4812a4f.js"><link rel="prefetch" href="/assets/js/5.a4579cc3.js"><link rel="prefetch" href="/assets/js/50.057477ee.js"><link rel="prefetch" href="/assets/js/51.b30da49d.js"><link rel="prefetch" href="/assets/js/52.d4a39ec0.js"><link rel="prefetch" href="/assets/js/53.f005fe5f.js"><link rel="prefetch" href="/assets/js/54.281c9bcc.js"><link rel="prefetch" href="/assets/js/55.d54fb613.js"><link rel="prefetch" href="/assets/js/56.024e66b7.js"><link rel="prefetch" href="/assets/js/57.0365506e.js"><link rel="prefetch" href="/assets/js/58.a11ca324.js"><link rel="prefetch" href="/assets/js/59.3fda10ec.js"><link rel="prefetch" href="/assets/js/6.798b30c2.js"><link rel="prefetch" href="/assets/js/60.5b7df878.js"><link rel="prefetch" href="/assets/js/61.ef712f70.js"><link rel="prefetch" href="/assets/js/62.02a85d83.js"><link rel="prefetch" href="/assets/js/63.f4bc54c1.js"><link rel="prefetch" href="/assets/js/64.5082196e.js"><link rel="prefetch" href="/assets/js/65.0903bdd0.js"><link rel="prefetch" href="/assets/js/66.d25c3ee3.js"><link rel="prefetch" href="/assets/js/67.5c5affb5.js"><link rel="prefetch" href="/assets/js/68.1a9084bf.js"><link rel="prefetch" href="/assets/js/69.409ad449.js"><link rel="prefetch" href="/assets/js/7.55c9c8ea.js"><link rel="prefetch" href="/assets/js/70.21a6aff1.js"><link rel="prefetch" href="/assets/js/71.c26a8d43.js"><link rel="prefetch" href="/assets/js/72.5fef98ad.js"><link rel="prefetch" href="/assets/js/73.fd12b317.js"><link rel="prefetch" href="/assets/js/74.f4ea8a41.js"><link rel="prefetch" href="/assets/js/75.b12c3dbe.js"><link rel="prefetch" href="/assets/js/76.cf5d3555.js"><link rel="prefetch" href="/assets/js/77.e2755fa8.js"><link rel="prefetch" href="/assets/js/78.17f53088.js"><link rel="prefetch" href="/assets/js/79.da213d97.js"><link rel="prefetch" href="/assets/js/8.24fe02a2.js"><link rel="prefetch" href="/assets/js/80.732350c0.js"><link rel="prefetch" href="/assets/js/81.c2504c6a.js"><link rel="prefetch" href="/assets/js/82.a655ba31.js"><link rel="prefetch" href="/assets/js/83.2fae6d0a.js"><link rel="prefetch" href="/assets/js/84.be2b6907.js"><link rel="prefetch" href="/assets/js/85.4c229e34.js"><link rel="prefetch" href="/assets/js/86.6bde2329.js"><link rel="prefetch" href="/assets/js/87.bb776dea.js"><link rel="prefetch" href="/assets/js/9.966ecb00.js">
    <link rel="stylesheet" href="/assets/css/0.styles.80bd9150.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="zengbotao" class="logo"> <span class="site-name can-hide">zengbotao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/about/jianli.html" class="nav-link">
  关于我
</a></div><div class="nav-item"><a href="https://github.com/zengbotao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  项目经验
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/about/jianli.html" class="nav-link">
  关于我
</a></div><div class="nav-item"><a href="https://github.com/zengbotao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  项目经验
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">主页</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>博客搭建</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端项目笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/elementUI节点树添加右键菜单组件.html" class="sidebar-link">elementUI节点树添加右键菜单组件</a></li><li><a href="/vue/vue2学习笔记.html" class="sidebar-link">vue2学习笔记</a></li><li><a href="/vue/vue3新特性.html" class="sidebar-link">vue3新特性</a></li><li><a href="/vue/简易的拖拽看板源代码.html" class="sidebar-link">简易的拖拽看板源代码</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>react</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/react-redux.html" class="sidebar-link">react-redux</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webpack/Webpack打包优化.html" class="sidebar-link">Webpack打包优化</a></li><li><a href="/webpack/Webpack打包实例.html" class="sidebar-link">Webpack打包实例</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>vite</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vite/vite改造vue3项目及其配置源码.html" class="sidebar-link">vite改造vue3项目及其配置源码</a></li><li><a href="/vite/vite笔记.html" class="active sidebar-link">vite笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_1vite前言" class="sidebar-link">1Vite前言</a></li><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_2什么是构建工具" class="sidebar-link">2什么是构建工具</a></li><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_3vite相较于webpack的优势" class="sidebar-link">3vite相较于webpack的优势</a></li><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_4vite的基本使用" class="sidebar-link">4vite的基本使用</a></li><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_5在vite中处理css" class="sidebar-link">5在vite中处理css</a></li><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_6vite在生产环境对静态资源的处理" class="sidebar-link">6vite在生产环境对静态资源的处理</a></li><li class="sidebar-sub-header"><a href="/vite/vite笔记.html#_7vite-config-js" class="sidebar-link">7vite.config.js</a></li></ul></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>网页优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/script标签上使用defer和async的区别.html" class="sidebar-link">script标签上使用defer和async的区别</a></li><li><a href="/note/如何提高网页加载速.html" class="sidebar-link">如何提高网页加载速</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端项目笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1vite前言"><a href="#_1vite前言" class="header-anchor">#</a> 1Vite前言</h2> <p>需要了解的背景知识</p> <ol><li>什么是构建工具?</li> <li>webpack的一个缺点在哪</li> <li>es module的规范</li> <li>vite他到底是什么东西</li> <li>vite的基本安装和使用</li> <li>vite的编译结果</li> <li>vite编译结果的分析</li> <li>vite的配置文件</li> <li>vite中处理css, 静态资源怎么去做</li> <li>vite的插件以及常用插件的使用</li> <li>vite与ts的结合</li> <li>vite生产打包</li> <li>vite构建react项目, vue3项目</li> <li>vite的一个构建原理</li></ol> <h2 id="_2什么是构建工具"><a href="#_2什么是构建工具" class="header-anchor">#</a> 2什么是构建工具</h2> <blockquote><p>浏览器他只认识html, css, js</p></blockquote> <p>企业级项目里都可能会具备哪些功能</p> <ol><li>typescript: 如果遇到ts文件我们需要使用tsc将typescript代码转换为js代码</li> <li>React/Vue: 安装react-compiler / vue-complier, 将我们写的jsx文件或者.vue文件转换为render函数</li> <li>less/sass/postcss/component-style: 我们又需要安装less-loader, sass-loader等一系列编译工具</li> <li>语法降级: babel ---&gt; 将es的新语法转换旧版浏览器可以接受的语法</li> <li>体积优化: uglifyjs ---&gt; 将我们的代码进行压缩变成体积更小性能更高的文件</li></ol> <p>稍微改一点点东西,需要一部一部解析，非常麻烦，如下</p> <p>将App.tsx ---&gt; tsc ---&gt; App.jsx ---&gt; React-complier ---&gt; js文件</p> <p>这个时候就用到了<strong>构建工具</strong>：帮你把tsc, react-compiler, less, babel, uglifyjs全部集成到一起</p> <p>我们只需要关心我们写的代码就好了，它自动去tsc, react-compiler, less, babel, uglifyjs全部挨个走一遍</p> <blockquote><p>打包: 将我们写的浏览器不认识的代码 交给构建工具进行编译处理的过程就叫做打包, 打包完成以后会给我们一个浏览器可以认识的文件</p></blockquote> <p>一个构建工具他到底承担了哪些脏活累活:</p> <ol><li>模块化开发支持: 支持直接从node_modules里引入代码 + 多种模块化支持</li> <li>处理代码兼容性: 比如babel语法降级, less,ts 语法转换(<strong>不是构建工具做的, 构建工具将这些语法对应的处理工具集成进来自动化处理</strong>)</li> <li>提高项目性能: 压缩文件, <strong>代码分割</strong></li> <li>优化开发体验:
<ul><li>构建工具会帮你自动监听文件的变化, 当文件变化以后自动帮你调用对应的集成工具进行重新打包, 然后再浏览器重新运行（整个过程叫做热更新, hot replacement</li> <li>开发服务器: 跨域的问题, 用react-cli create-react-element vue-cli  解决跨域的问题,
每次改一点 ---&gt; 这个顺序还不能错</li></ul></li></ol> <p>构建工具他让我们可以不用每次都关心我们的代码在浏览器如何运行, 我们只需要首次给构建工具提供一个配置文件(这个配置文件也不是必须的, 如果你不给他 他会有默认的帮你去处理), 有了这个集成的配置文件以后, 再结合热更新, 我们就更加不需要管任何东西。
<strong>构建工具让我们不用关心生产的代码也不用关心代码如何在浏览器运行, 只需要关心我们的开发怎么写的爽怎么写就好了</strong></p> <p>市面上主流的构建工具有哪些:</p> <ul><li>webpack</li> <li>vite</li> <li>parcel</li> <li>esbuild</li> <li>rollup</li> <li>grunt</li> <li>gulp</li></ul> <h2 id="_3vite相较于webpack的优势"><a href="#_3vite相较于webpack的优势" class="header-anchor">#</a> 3vite相较于webpack的优势</h2> <p>官方文档: https://cn.vitejs.dev/guide/why.html##the-problems</p> <p>然而，当我们开始构建越来越大型的应用时，需要处理的 JavaScript 代码量也呈指数级增长。包含数千个模块的大型项目相当普遍。我们开始遇到性能瓶颈 —— 使用 JavaScript 开发的工具通常需要很长时间（甚至是几分钟！）才能启动开发服务器，即使使用 HMR(热更新)，文件修改后的效果也需要几秒钟才能在浏览器中反映出来。如此循环往复，迟钝的反馈会极大地影响开发者的开发效率和幸福感。
起因: 我们的项目越大 ----&gt; 构建工具（webpack）所要处理的js代码就越多 【跟webpack的一个构建过程（工作流程）有关系】
造成的结果: 构建工具需要很长时间才能启动开发服务器 (启动开发服务器 ---&gt; 把项目跑起来)</p> <p>这是由于webpack支持多种模块化的原因，它支持commonjs和es6语法，一开始必须要统一模块化代码, 所以意味着他需要将所有的依赖全部读一遍，就非常的耗时</p> <p>注: 加入你的工程可能不只是跑在浏览器端，使用vite会更快
vite是基于es modules的, 侧重点不一样, webpack更多的关注兼容性, 而vite关注浏览器端的开发体验</p> <ul><li>vite的上手难度更低,内置了相对最优化的配置，对个人自定义开发的要求更低。而 webpack的配置是非常多的, loader, plugin</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token comment">// 这一段代码最终会到浏览器里去运行</span>
<span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// commonjs 规范</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span> <span class="token comment">// es6 module</span>

<span class="token comment">// webpack是允许我们这么写的</span>
</code></pre></div><p>webpack的编译原理, AST 抽象语法分析的工具 分析出你写的这个js文件有哪些导入和导出操作
构建工具是运行在服务端的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack的一个转换结果</span>
<span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">webpack_require</span><span class="token punctuation">(</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Vue <span class="token operator">=</span> <span class="token function">webpack_require</span><span class="token punctuation">(</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">webpack_require</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 入口是index.js</span>
    <span class="token comment">// 通过webpack的配置文件得来的: webpack.config.js ./src/index.js</span>
    modules<span class="token punctuation">[</span>entry<span class="token punctuation">]</span><span class="token punctuation">(</span>webpack_require<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;./src/index.js&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">webpack_require</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">webpack_require</span><span class="token punctuation">(</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> Vue <span class="token operator">=</span> <span class="token function">webpack_require</span><span class="token punctuation">(</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_4vite的基本使用"><a href="#_4vite的基本使用" class="header-anchor">#</a> 4vite的基本使用</h2> <h3 id="_4-1搭建vite工程"><a href="#_4-1搭建vite工程" class="header-anchor">#</a> 4.1搭建vite工程</h3> <p>vite官网搭建工程指南: https://vitejs.dev/guide/##scaffolding-your-first-vite-project
vite对node版本有要求，部分插件也要求vue在3.2.5以上；
我之前的一个练手的项目：https://blog.csdn.net/weixin_46544034/article/details/127415269?</p> <ul><li><p>使用自选配置去构建vite项目:</p> <div class="language- extra-class"><pre class="language-text"><code>yarn create vite
</code></pre></div></li> <li><p>构建一些具备框架功能的预设模板(不需要你自选配置)</p> <div class="language- extra-class"><pre class="language-text"><code>yarn create vite my-react-ts-app --template react-ts ## 还有更多配置可以参阅官网
</code></pre></div></li> <li><p>vuex, vue-router,</p></li></ul> <h3 id="_4-2vite启动项目初体验"><a href="#_4-2vite启动项目初体验" class="header-anchor">#</a> 4.2vite启动项目初体验</h3> <p>记住，在vite项目里面，不要使用commonjs 规范语法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token comment">// 这一段代码最终会到浏览器里去运行</span>
<span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// commonjs 规范</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span> <span class="token comment">// es6 module，这个才是vite</span>
</code></pre></div><p>开箱即用(out of box): 你不需要做任何额外的配置就可以使用vite来帮你处理构建工作
在默认情况下, 我们的esmodule去导入资源的时候, 要么是绝对路径, 要么是相对路径
既然我们现在的最佳实践就是node_modules, 那为什么es官方在我们导入非绝对路径和非相对路径的资源的时候不默认帮我们 搜寻node_modules呢？
假设浏览器做了这个事情
vite: 代码处理</p> <h3 id="_4-3vite的预加载"><a href="#_4-3vite的预加载" class="header-anchor">#</a> 4.3vite的预加载</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">;</span> <span class="token comment">// lodash可能也import了其他的东西</span>
</code></pre></div><p>在处理的过程中如果说看到了有非绝对路径或者相对路径的引用, 他则会尝试开启路径补全</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&quot;/node_modules/.vite/lodash&quot;</span><span class="token punctuation">;</span> <span class="token comment">// lodash可能也import了其他的东西</span>

<span class="token keyword">import</span> __vite__cjsImport0_lodash <span class="token keyword">from</span> <span class="token string">&quot;/node_modules/.vite/deps/lodash.js?v=ebe57916&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>找寻依赖的过程是自当前目录依次向上查找的过程, 直到搜寻到根目录或者搜寻到对应依赖为止 /user/node_modules/lodash, ../</p> <p>生产 和开发</p> <p>yarn dev ---&gt; 开发(每次依赖预构建所重新构建的相对路径都是正确的)</p> <p>vite会全权交给一个叫做rollup的库去完成生产环境的打包</p> <p>缓存 ---&gt;</p> <p>实际上vite在考虑另外一个问题的时候就顺便把这个问题解决了</p> <p>commonjs 规范的导出 module.exports</p> <p>有的包他是以commonjs规范的格式导出 axios</p> <p><strong>依赖预构建</strong>: 首先vite会找到对应的依赖, 然后调用esbuild(对js语法进行处理的一个库), 将其他规范的代码转换成esmodule规范, 然后放到<strong>当前目录下的node_modules/.vite/deps</strong>, 同时对esmodule规范的各个模块进行统一集成</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a </span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> a  <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./a.js&quot;</span>
</code></pre></div><p>vite重写以后</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>他解决了3个问题:</p> <ol><li>不同的第三方包会有不同的导出格式(这个是vite没法约束人家的事情)</li> <li>对路径的处理上可以直接使用.vite/deps, 方便路径重写，</li> <li>叫做网络多包传输的性能问题(也是原生esmodule规范不敢支持node_modules的原因之一), 有了依赖预构建以后无论他有多少的额外export 和import, vite都会尽可能的将他们进行集成最后只生成一个或者几个模块</li></ol> <p>vite.config.js === webpack.config.js，是vite的配置文件</p> <h3 id="_4-4vite为什么可以实现按需加载"><a href="#_4-4vite为什么可以实现按需加载" class="header-anchor">#</a> 4.4vite为什么可以实现按需加载</h3> <p>在 vite 官网上给的答案是，为了解决开发服务器启动缓慢和热更新缓慢的问题，提升开发效率和开发幸福感！拿 webpack 来说，开发服务器启动时，webpack 会通过入口文件，解析出所有依赖的资源，并执行这些资源的转义操作，构建出整个应用后才能提供服务。当一个项目包含上千个模块时，一次构建出整个应用的模式就遇到性能瓶颈了。vite 的做法是抛弃打包过程，按需构建，前端请求到哪个模块，再去构建这个模块。并且 vite 还使用了 esbuild 和预构建第三方库的优化手段，进一步提升按需构建的速度。</p> <h3 id="_4-5vite和ts的结合"><a href="#_4-5vite和ts的结合" class="header-anchor">#</a> 4.5vite和ts的结合</h3> <blockquote><p>vite他天生就对ts支持非常良好, 因为vite在开发时态是基于esbuild, 而esbuild是天生支持对ts文件的转换的</p></blockquote> <p>那么对ts的校验呢？</p> <blockquote><p>vite只对ts文件进行转换, 并不会对ts文件进行类型检查</p></blockquote> <ol><li>安装一个插件: vite-plugin-eslint
我们的这个插件只会在开发时态帮助我们校验ts语法</li></ol> <p>为什么我们在vite.config.js里可以使用esmodule: 主要是因为vite在读取配置文件并执行的前一刻会进行替换</p> <h2 id="_5在vite中处理css"><a href="#_5在vite中处理css" class="header-anchor">#</a> 5在vite中处理css</h2> <h3 id="_5-1vite天生就支持对css文件的直接处理"><a href="#_5-1vite天生就支持对css文件的直接处理" class="header-anchor">#</a> 5.1vite天生就支持对css文件的直接处理</h3> <ol><li>vite在读取到main.js中引用到了Index.css</li> <li>直接去使用fs模块去读取index.css中文件内容</li> <li>直接创建一个style标签, 将index.css中文件内容直接copy进style标签里</li> <li>将style标签插入到index.html的head中</li> <li>将该css文件中的内容直接替换为js脚本(方便热更新或者css模块化), 同时设置Content-Type为js 从而让浏览器以JS脚本的形式来执行该css后缀的文件</li></ol> <p>场景:</p> <ul><li>一个组件最外层的元素类名一般取名 : wrapper</li> <li>一个组件最底层的元素我们一般取名: .footer</li></ul> <p>你取了footer这个名字, 别人因为没有看过你这个组件的源代码, 也可能去取名footer这个类名</p> <p>最终可能会导致样式被覆盖（因为类名重复）, 这就是我们在协同开发的时候很容易出现的问题</p> <p>cssmodule就是来解决这个问题的</p> <p>大概说一下原理:</p> <p>全部都是基于node</p> <ol><li>module.css (module是一种约定, 表示需要开启css模块化)</li> <li>他会将你的所有类名进行一定规则的替换（将footer 替换成 _footer_i22st_1）</li> <li>同时创建一个映射对象{ footer: &quot;_footer_i22st_1&quot; }</li> <li>将替换过后的内容塞进style标签里然后放入到head标签中 (能够读到index.html的文件内容)</li> <li>将componentA.module.css内容进行全部抹除, 替换成JS脚本</li> <li>将创建的映射对象在脚本中进行默认导出</li></ol> <p>less(预处理器): less给我们提供了一些方便且非常实用的方法</p> <h3 id="_5-2css配置-modules篇"><a href="#_5-2css配置-modules篇" class="header-anchor">#</a> 5.2css配置（modules篇）</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对css的行为进行配置</span>
    <span class="token comment">// modules配置最终会丢给postcss modules</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 是对css模块化的默认行为进行覆盖</span>
      <span class="token literal-property property">localsConvention</span><span class="token operator">:</span> <span class="token string">&quot;camelCaseOnly&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 修改生成的配置对象的key的展示形式(驼峰还是中划线形式)</span>
      <span class="token literal-property property">scopeBehaviour</span><span class="token operator">:</span> <span class="token string">&quot;local&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 配置当前的模块化行为是模块化还是全局化 (有hash就是开启了模块化的一个标志, 因为他可以保证产生不同的hash值来控制我们的样式类名不被覆盖)</span>
      <span class="token comment">// generateScopedName: &quot;[name]_[local]_[hash:5]&quot; // https://github.com/webpack/loader-utils##interpolatename</span>
      <span class="token comment">// generateScopedName: (name, filename, css) =&gt; {</span>
      <span class="token comment">//     // name -&gt; 代表的是你此刻css文件中的类名</span>
      <span class="token comment">//     // filename -&gt; 是你当前css文件的绝对路径</span>
      <span class="token comment">//     // css -&gt; 给的就是你当前样式</span>
      <span class="token comment">//     console.log(&quot;name&quot;, name, &quot;filename&quot;, filename, &quot;css&quot;, css); // 这一行会输出在哪？？？ 输出在node</span>
      <span class="token comment">//     // 配置成函数以后, 返回值就决定了他最终显示的类型</span>
      <span class="token comment">//     return `${name}_${Math.random().toString(36).substr(3, 8) }`;</span>
      <span class="token comment">// }</span>
      <span class="token literal-property property">hashPrefix</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 生成hash会根据你的类名 + 一些其他的字符串(文件名 + 他内部随机生成一个字符串)去进行生成, 如果你想要你生成hash更加的独特一点, 你可以配置hashPrefix, 你配置的这个字符串会参与到最终的hash生成, （hash: 只要你的字符串有一个字不一样, 那么生成的hash就完全不一样, 但是只要你的字符串完全一样, 生成的hash就会一样）</span>
      <span class="token literal-property property">globalModulePaths</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./componentB.module.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 代表你不想参与到css模块化的路径，要定义全局模块的路径，请使用globalModulePaths选项。</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span>
</code></pre></div><p>css.modules的配置信息：https://cn.vitejs.dev/config/shared-options.html##css-modules
配置 CSS modules 的行为，选项将被传递给 postcss-modules：https://github.com/madyankin/postcss-modules</p> <ul><li>localConvention: 修改生成的配置对象的key的展示形式(驼峰还是中划线形式)</li> <li>scopeBehaviour: 配置当前的模块化行为是模块化还是全局化 (有hash就是开启了模块化的一个标志, 因为他可以保证产生不同的hash值来控制我们的样式类名不被覆盖)</li> <li>generateScopedName: 生成的类名的规则(可以配置为函数, 也可以配置成字符串规则: https://github.com/webpack/loader-utils##interpolatename)</li> <li>hashPrefix: 生成hash会根据你的类名 + 一些其他的字符串(文件名 + 他内部随机生成一个字符串)去进行生成, 如果你想要你生成hash更加的独特一点, 你可以配置hashPrefix, 你配置的这个字符串会参与到最终的hash生成, （hash: 只要你的字符串有一个字不一样, 那么生成的hash就完全不一样, 但是只要你的字符串完全一样, 生成的hash就会一样）</li> <li>globalModulePaths: 代表你不想参与到css模块化的路径</li></ul> <h3 id="_5-3vite与postcss"><a href="#_5-3vite与postcss" class="header-anchor">#</a> 5.3vite与postcss</h3> <p>vite天生对postcss有非常良好的支持，
注意！！！：<strong>直接在css.postcss中进行配置, 该属性直接配置的就是postcss的配置</strong></p> <p><strong>都对postcss有一个误区: 他们认为postcss和less sass是差不多级别</strong></p> <p>我们写的css代码(怎么爽怎么来) --&gt; postcss ---&gt; less --&gt; 再次对未来的高级css语法进行降级 --&gt; 前缀补全 --&gt; 浏览器客户端</p> <p>目前来说 less和sass等一系列预处理器的postcss插件已经停止维护了 less插件 你自己去用less和sass编译完了, 然后你把编译结果给我</p> <p><strong>所以业内就产生了一个新的说法: postcss是后处理器</strong> less的postcss的插件就ok了</p> <p>我们写的js代码(怎么爽怎么来) --&gt; babel --&gt; 将最新的ts语法进行转换js语法 --&gt; 做一次语法降级  --&gt; 浏览器客户端去执行</p> <p>babel --&gt; 帮助我们让js执行起来万无一失</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// es6的写法</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// es3的语法</span>
</code></pre></div><p>浏览器的兼容性你能考虑到吗, 预处理器并不能够解决这些问题:</p> <ol><li>对未来css属性的一些使用降级问题</li> <li>前缀补全: Google非常卷 --webkit</li></ol> <h2 id="_6vite在生产环境对静态资源的处理"><a href="#_6vite在生产环境对静态资源的处理" class="header-anchor">#</a> 6vite在生产环境对静态资源的处理</h2> <p>当我们将工程进行打包以后, 会发现找不到原来的资源</p> <p>baseUrl: &quot;/&quot;，这个很重要</p> <p>打包后的静态资源为什么要有hash</p> <p>浏览器是有一个缓存机制 静态资源名字只要不改, 那么他就会直接用缓存的</p> <p>刷新页面: 请求的名字是不是同一个 读取缓存</p> <p>所以我们要尽量去避免名字一致</p> <p>hash算法: 将一串字符串经过运算得到一个新的乱码字符串 全世界独一无二(uuid才是独一无二的 )</p> <p>利用好hash算法 可以让我们更好的去控制浏览器的缓存机制</p> <p>base64图片</p> <h2 id="_7vite-config-js"><a href="#_7vite-config-js" class="header-anchor">#</a> 7vite.config.js</h2> <h3 id="_7-1-vite-base-config-js"><a href="#_7-1-vite-base-config-js" class="header-anchor">#</a> 7.1 vite.base.config.js</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vite.base.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ViteAliases <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite-aliases&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> viteCompression <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-compression&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> MyViteAliases <span class="token keyword">from</span> <span class="token string">&quot;./plugins/ViteAliases&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createHtmlPlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-html&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> CreateHtmlPlugin <span class="token keyword">from</span> <span class="token string">&quot;./plugins/CreateHtmlPlugin&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> viteMockServe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-mock&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> VitePluginMock <span class="token keyword">from</span> <span class="token string">&quot;./plugins/VitePluginMock&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">optimizeDeps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 将指定数组中的依赖不进行依赖预构建</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">5333</span><span class="token punctuation">,</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">envPrefix</span><span class="token operator">:</span> <span class="token string">&quot;ENV_&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 对css的行为进行配置</span>
    <span class="token comment">// modules配置最终会丢给postcss modules</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 是对css模块化的默认行为进行覆盖</span>
      <span class="token literal-property property">localsConvention</span><span class="token operator">:</span> <span class="token string">&quot;camelCaseOnly&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 修改生成的配置对象的key的展示形式(驼峰还是中划线形式)</span>
      <span class="token literal-property property">scopeBehaviour</span><span class="token operator">:</span> <span class="token string">&quot;local&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 配置当前的模块化行为是模块化还是全局化 (有hash就是开启了模块化的一个标志, 因为他可以保证产生不同的hash值来控制我们的样式类名不被覆盖)</span>
      <span class="token comment">// generateScopedName: &quot;[name]_[local]_[hash:5]&quot; // https://github.com/webpack/loader-utils##interpolatename</span>
      <span class="token comment">// generateScopedName: (name, filename, css) =&gt; {</span>
      <span class="token comment">//     // name -&gt; 代表的是你此刻css文件中的类名</span>
      <span class="token comment">//     // filename -&gt; 是你当前css文件的绝对路径</span>
      <span class="token comment">//     // css -&gt; 给的就是你当前样式</span>
      <span class="token comment">//     console.log(&quot;name&quot;, name, &quot;filename&quot;, filename, &quot;css&quot;, css); // 这一行会输出在哪？？？ 输出在node</span>
      <span class="token comment">//     // 配置成函数以后, 返回值就决定了他最终显示的类型</span>
      <span class="token comment">//     return `${name}_${Math.random().toString(36).substr(3, 8) }`;</span>
      <span class="token comment">// }</span>
      <span class="token literal-property property">hashPrefix</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 生成hash会根据你的类名 + 一些其他的字符串(文件名 + 他内部随机生成一个字符串)去进行生成, 如果你想要你生成hash更加的独特一点, 你可以配置hashPrefix, 你配置的这个字符串会参与到最终的hash生成, （hash: 只要你的字符串有一个字不一样, 那么生成的hash就完全不一样, 但是只要你的字符串完全一样, 生成的hash就会一样）</span>
      <span class="token literal-property property">globalModulePaths</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./componentB.module.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 代表你不想参与到css模块化的路径</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">preprocessorOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// key + config key代表预处理器的名</span>
      <span class="token literal-property property">less</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 整个的配置对象都会最终给到less的执行参数（全局参数）中去</span>
        <span class="token comment">// 在webpack里就给less-loader去配置就好了</span>
        <span class="token literal-property property">math</span><span class="token operator">:</span> <span class="token string">&quot;always&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">globalVars</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 全局变量</span>
          <span class="token literal-property property">mainColor</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devSourcemap</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// reportCompressedSize: false,</span>
    <span class="token literal-property property">rollupOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 配置rollup的一些构建策略</span>
      <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 控制输出</span>
        <span class="token comment">// 在rollup里面, hash代表将你的文件名和文件内容进行组合计算得来的结果</span>
        <span class="token literal-property property">assetFileNames</span><span class="token operator">:</span> <span class="token string">&quot;[hash].[name].[ext]&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">chunkFileNames</span><span class="token operator">:</span> <span class="token string">&quot;static/js/[name]-[hash].js&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">entryFileNames</span><span class="token operator">:</span> <span class="token string">&quot;static/js/[name]-[hash].js&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">assetsInlineLimit</span><span class="token operator">:</span> <span class="token number">4096000</span><span class="token punctuation">,</span> <span class="token comment">// 4000kb</span>
    <span class="token literal-property property">outDir</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">assetsDir</span><span class="token operator">:</span> <span class="token string">&quot;static&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// sourcemap: true,</span>
    <span class="token literal-property property">emptyOutDir</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">MyViteAliases</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">viteCompression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// ViteAliases()</span>
    <span class="token comment">// createHtmlPlugin({</span>
    <span class="token comment">//     inject: {</span>
    <span class="token comment">//         data: {</span>
    <span class="token comment">//             title: &quot;主页&quot;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     }</span>
    <span class="token comment">// })</span>
    <span class="token function">CreateHtmlPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;主页2&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// serve === 开启开发服务器</span>
    <span class="token function">viteMockServe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// VitePluginMock()</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_7-2-vite识别vue文件"><a href="#_7-2-vite识别vue文件" class="header-anchor">#</a> 7.2 vite识别vue文件</h4> <p>vite识别vue文件需要引入插件，有时还需要修改alias</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/10/2022, 8:55:17 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vite/vite改造vue3项目及其配置源码.html" class="prev">
        vite改造vue3项目及其配置源码
      </a></span> <span class="next"><a href="/note/script标签上使用defer和async的区别.html">
        script标签上使用defer和async的区别
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.6347ca4c.js" defer></script><script src="/assets/js/10.5d924c5c.js" defer></script><script src="/assets/js/45.2b87470c.js" defer></script><script src="/assets/js/12.da65b27a.js" defer></script>
  </body>
</html>
